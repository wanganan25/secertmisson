<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>機密代號</title>
  <style>
    :root {
      font-family: "Noto Sans TC", "Microsoft JhengHei", system-ui, sans-serif;
      color-scheme: light dark;
      --bg: #0f172a;
      --panel: rgba(15,23,42,.76);
      --accent: #38bdf8;
      --accent-dark: #6366f1;
      --ink: #e2e8f0;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      padding: clamp(1.5rem, 4vw, 3rem);
      background: radial-gradient(circle at top, #1e293b, #0f172a 65%);
      color: var(--ink);
    }
    main {
      width: min(1120px, 100%);
      background: var(--panel);
      border-radius: 28px;
      box-shadow: 0 30px 70px rgba(37,99,235,.35);
      padding: clamp(2rem, 4vw, 3rem);
      display: grid;
      gap: 2rem;
    }
    header h1 { margin:0 0 .6rem; font-size: clamp(2rem,4vw,2.8rem); letter-spacing:.08em; }
    header p  { margin:0; line-height:1.7; color:#cbd5f5; }

    section {
      background: rgba(14,35,64,.65);
      border: 1px solid rgba(59,130,246,.35);
      border-radius: 22px;
      padding: clamp(1.3rem,3vw,2rem);
      display: grid;
      gap: 1.1rem;
    }
    section h2 {
      margin:0;
      font-size: clamp(1.3rem,3vw,1.7rem);
      display:flex; align-items:center; gap:.8rem;
    }
    section h2 span {
      display:inline-flex; align-items:center; justify-content:center;
      width:2.1rem; height:2.1rem; border-radius:50%;
      background:linear-gradient(135deg,var(--accent),var(--accent-dark));
      color:#0f172a; font-weight:700;
    }

    input, button, select { font: inherit; }
    input {
      width: 100%; padding: .65rem 1rem; border-radius: 14px;
      border: 1px solid rgba(148,163,184,.38); background: rgba(15,23,42,.8); color: #e2e8f0;
    }
    button {
      border:none; border-radius:999px; padding:.7rem 1.4rem;
      font-weight:600; cursor:pointer; display:inline-flex;
      align-items:center; justify-content:center; gap:.4rem;
      background:linear-gradient(135deg,var(--accent),var(--accent-dark));
      color:#0f172a; box-shadow:0 14px 24px rgba(99,102,241,.35);
      transition:transform .18s ease, box-shadow .18s ease;
    }
    button:hover { transform:translateY(-2px); box-shadow:0 20px 36px rgba(99,102,241,.45); }
    button:active { transform:translateY(1px); }
    button[disabled] { opacity:.55; cursor:not-allowed; transform:none; box-shadow:none; }
    .ghost { background:rgba(148,163,184,.18); color:#e2e8f0; box-shadow:none; }

    .room-grid { display:grid; gap:1rem; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); }
    .room-card {
      border-radius:18px;
      border:1px solid rgba(96,165,250,.35);
      background:rgba(17,37,74,.8);
      padding:1rem 1.2rem;
      display:grid; gap:.6rem;
      box-shadow:0 10px 24px rgba(59,130,246,.28);
    }
    .room-card.active { border:2px solid var(--accent); box-shadow:0 14px 30px rgba(99,102,241,.4); }
    .badges { display:flex; gap:.5rem; flex-wrap:wrap; font-size:.85rem; color:#dbeafe; }
    .pill { display:inline-flex; align-items:center; padding:.3rem .7rem; border-radius:999px; background:rgba(59,130,246,.18); font-size:.85rem; }

    table { width:100%; border-collapse:collapse; color:#e2e8f0; }
    th,td { padding:.65rem .75rem; border-bottom:1px solid rgba(148,163,184,.18); text-align:left; }
    tbody tr.current-player { background:rgba(34,197,94,.2); }
    tbody tr.eliminated    { background:rgba(248,113,113,.25); }

    .hand { display:flex; flex-wrap:wrap; gap:.4rem; }
    .hand span { background:rgba(148,163,184,.2); border-radius:12px; padding:.3rem .6rem; }

    .hidden { display:none!important; }
    footer { text-align:center; font-size:.95rem; color:#cbd5f5; }
    footer a { color:#e0f2fe; text-decoration:none; font-weight:600; }
  </style>
</head>
<body>
  <main>
    <header>
      <h1>機密代號 · 多人同步版</h1>
      <p>選擇房間並輸入暱稱即可加入，同步管理線索、翻牌與剩餘任務。房主可重置房間或踢出玩家。</p>
    </header>

    <section id="room-selection">
      <h2><span>01</span>選擇房間與暱稱</h2>
      <p style="margin:0;color:#dbeafe;">請先加入房間，再輸入暱稱確認。房主負責開始/重設遊戲以及踢出玩家。</p>

      <div id="room-cards" class="room-grid"></div>

      <div style="display:grid;gap:1rem;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));align-items:end;">
        <div>
          <label for="nickname">我的暱稱</label>
          <input id="nickname" type="text" placeholder="輸入暱稱">
        </div>
        <div id="current-room-box" class="hidden">
          <strong id="current-room-name">目前未加入房間</strong>
          <p id="current-room-count" style="margin:.35rem 0 0;font-size:.95rem;color:#cbd5f5;">—</p>
          <div style="display:flex;gap:.6rem;flex-wrap:wrap;margin-top:.6rem;">
            <button id="ready-btn" class="ghost">我準備好了</button>
            <button id="leave-room-btn" class="ghost">離開房間</button>
            <button id="start-btn" class="ghost" style="display:none;">房主開始遊戲</button>
          </div>
        </div>
      </div>
    </section>

    <section id="status-panel" class="hidden">
      <h2><span>02</span>房間狀態</h2>
      <p id="game-status">遊戲狀態：等待開始</p>
      <p id="turn-status">輪到：—</p>
    </section>

    <section id="players-panel" class="hidden">
      <h2><span>03</span>玩家狀況</h2>
      <div style="overflow-x:auto;">
        <table>
          <thead>
            <tr><th>玩家</th><th>陣營</th><th>準備</th><th>操作</th></tr>
          </thead>
          <tbody id="player-table"></tbody>
        </table>
      </div>
      <div style="display:flex;gap:.8rem;flex-wrap:wrap;">
        <button id="btn-reset-room" class="ghost">重設房間（保留玩家）</button>
      </div>
    </section>

    <section id="board-panel" class="hidden">
      <h2><span>04</span>密語任務地圖</h2>
      <div style="display:flex;gap:.8rem;flex-wrap:wrap;align-items:center;">
        <button id="toggle-map-btn" class="ghost">切換隊長視角</button>
        <span class="pill" id="remaining-info">任務尚未開始</span>
      </div>
      <div id="board" style="display:grid;grid-template-columns:repeat(5,minmax(0,1fr));gap:.8rem;"></div>
    </section>

    <footer>
      <p>當所有人準備完成，房主即可開局。翻牌同步顯示，雷隊翻牌與刺客機制沿用桌遊規則。｜<a href="index.html#">重新整理</a></p>
    </footer>
  </main>
  <script type="module" src="app.js"></script>
</body>
</html>
