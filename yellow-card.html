<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>黃牌大挑戰｜多人同步</title>
  <style>
    :root {
      font-family: "Noto Sans TC", "Microsoft JhengHei", system-ui, sans-serif;
      color-scheme: light dark;
      --bg: #fef3c7;
      --panel: #fffdf5;
      --accent: #facc15;
      --accent-dark: #f97316;
      --ink: #1f2937;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      min-height: 100vh;
      background: radial-gradient(circle at top, #fde68a, #f59e0b 65%);
      color: var(--ink);
      padding: clamp(1.5rem, 4vw, 3rem);
      display: flex;
      justify-content: center;
    }
    main {
      width: min(1100px, 100%);
      background: var(--panel);
      border-radius: 28px;
      box-shadow: 0 30px 70px rgba(249,115,22,.35);
      padding: clamp(2rem, 4vw, 3rem);
      display: grid;
      gap: 2rem;
    }
    header h1 {
      margin: 0 0 .6rem;
      font-size: clamp(2rem, 4vw, 2.8rem);
      letter-spacing: .08em;
    }
    header p {
      margin: 0;
      line-height: 1.7;
      color: #374151;
    }
    section {
      background: rgba(255,255,255,.86);
      border: 1px solid rgba(249, 158, 47, .35);
      border-radius: 22px;
      padding: clamp(1.4rem, 3vw, 2rem);
      display: grid;
      gap: 1.2rem;
    }
    section h2 {
      margin: 0;
      font-size: clamp(1.3rem, 3vw, 1.7rem);
      display: flex;
      align-items: center;
      gap: .8rem;
    }
    section h2 span {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 2.2rem;
      height: 2.2rem;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--accent), var(--accent-dark));
      color: #1f2937;
      font-weight: 700;
    }
    label { font-weight: 600; }
    input {
      font: inherit;
      width: 100%;
      padding: .65rem 1rem;
      border-radius: 14px;
      border: 1px solid rgba(15,23,42,.1);
      background: rgba(255,255,255,.92);
    }
    button {
      font: inherit;
      border: none;
      border-radius: 999px;
      padding: .7rem 1.4rem;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: .4rem;
      background: linear-gradient(135deg, var(--accent), var(--accent-dark));
      color: #1f2937;
      box-shadow: 0 14px 24px rgba(249,115,22,.3);
      transition: transform .18s ease, box-shadow .18s ease;
    }
    button:hover { transform: translateY(-2px); box-shadow: 0 18px 32px rgba(249,115,22,.4); }
    button:active { transform: translateY(1px); }
    button[disabled] { opacity: .55; cursor: not-allowed; transform: none; box-shadow: none; }
    .ghost { background: rgba(15,23,42,.08); box-shadow: none; }
    .grid-two { display: grid; gap: 1.2rem; }
    @media(min-width: 860px) { .grid-two { grid-template-columns: repeat(2, minmax(0,1fr)); } }
    .room-grid {
      display: grid;
      gap: 1rem;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    }
    .room-card {
      border-radius: 18px;
      border: 1px solid rgba(249, 158, 47, .35);
      background: rgba(255,255,255,.94);
      padding: 1rem 1.2rem;
      display: grid;
      gap: .6rem;
      box-shadow: 0 10px 24px rgba(249,115,22,.25);
    }
    .room-card.active { border: 2px solid var(--accent-dark); box-shadow: 0 14px 30px rgba(249,115,22,.35); }
    .room-card h3 { margin: 0; font-size: 1.2rem; }
    .badges { display: flex; gap: .5rem; flex-wrap: wrap; font-size: .85rem; color: #475569; }
    .pill {
      display: inline-flex;
      align-items: center;
      padding: .3rem .7rem;
      border-radius: 999px;
      background: rgba(15,23,42,.1);
      font-size: .85rem;
    }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: .65rem .75rem; border-bottom: 1px solid rgba(15,23,42,.08); text-align: left; }
    tbody tr.current-player { background: rgba(56,189,248,.15); }
    tbody tr.player-eliminated { background: rgba(248,113,113,.2); }
    .hand { display: flex; flex-wrap: wrap; gap: .4rem; }
    .hand span { background: rgba(15,23,42,.08); border-radius: 12px; padding: .3rem .6rem; }
    .hidden { display: none !important; }
    footer { text-align: center; font-size: .95rem; color: #4b5563; }
    footer a { color: #1f2937; text-decoration: none; font-weight: 600; }
  </style>
</head>
<body>
  <main>
    <header>
      <h1>瘋狂黃牌大挑戰 · 多人同步版</h1>
      <p>選擇房間、輸入暱稱後即可即時同步管理黃牌、題目卡與詞語牌庫。</p>
    </header>

    <section id="room-selection">
      <h2><span>01</span>選擇房間與暱稱</h2>
      <div class="grid-two">
        <div>
          <label for="nickname">我的暱稱</label>
          <input id="nickname" type="text" placeholder="輸入暱稱">
          <p style="margin:.4rem 0 0;font-size:.9rem;color:#64748b;">加入房間後，所有操作會自動同步至 Firestore。</p>
        </div>
        <div id="current-room-box" class="hidden">
          <strong id="current-room-name">目前未加入房間</strong>
          <p id="current-room-count" style="margin:.35rem 0 0;font-size:.95rem;color:#475569;">—</p>
          <div style="display:flex;gap:.6rem;flex-wrap:wrap;margin-top:.6rem;">
            <button id="leave-room-btn" class="ghost">離開房間</button>
          </div>
        </div>
      </div>
      <div id="room-cards" class="room-grid"></div>
    </section>

    <section id="players-panel" class="hidden">
      <h2><span>02</span>玩家黃牌＆手牌</h2>
      <div style="overflow-x:auto;">
        <table>
          <thead>
            <tr><th>玩家</th><th>黃牌</th><th>操作</th><th>手牌</th></tr>
          </thead>
          <tbody id="player-table"></tbody>
        </table>
      </div>
      <div style="display:flex;gap:.8rem;flex-wrap:wrap;">
        <button id="btn-next-round" class="ghost">下一局：清空黃牌與手牌</button>
        <button id="btn-reset-game" class="ghost">重設房間（重洗題目＋詞語）</button>
      </div>
    </section>

    <section id="topics-panel" class="hidden">
      <h2><span>03</span>題目卡控制</h2>
      <div style="display:flex;gap:.8rem;flex-wrap:wrap;align-items:center;">
        <button id="btn-draw-topic">抽題目卡</button>
        <button id="btn-reset-topics" class="ghost">重洗題目卡</button>
        <span class="pill" id="topic-remaining">剩餘題目：--</span>
      </div>
      <div class="room-card" style="background:rgba(254,240,138,.55);">
        <h3>目前題目</h3>
        <p id="topic-display" style="margin:0;line-height:1.5;">尚未抽題目</p>
      </div>
    </section>

    <section id="words-panel" class="hidden">
      <h2><span>04</span>詞語牌庫</h2>
      <div style="display:flex;gap:.8rem;flex-wrap:wrap;align-items:center;">
        <button id="btn-deal-cards">為所有玩家發 13 張詞語卡</button>
        <button id="btn-reset-deck" class="ghost">重洗牌庫</button>
        <span class="pill" id="word-remaining">牌庫剩餘：--</span>
      </div>
      <p style="margin:0;font-size:.9rem;color:#4b5563;">玩家若打出詞語卡，可在手牌欄按「補一張」。</p>
    </section>

    <footer>
      <p>遊戲結束後，黃牌最少者獲勝。祝活動順利！｜<a href="index.html">返回遊戲選擇</a></p>
    </footer>
  </main>
  <script type="module" src="yellow-card.js"></script>
</body>
</html>
